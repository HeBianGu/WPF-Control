<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:le="clr-namespace:H.Controls.Diagram.Presenter.Expressions">
    <DataTemplate DataType="{x:Type le:ExpressionComboBoxPropertyItem}">
        <Border>
            <Border.Resources>
                <CollectionViewSource x:Key="GroupedNodeDatas"
                                      Source="{Binding Collection}">
                    <CollectionViewSource.GroupDescriptions>
                        <PropertyGroupDescription PropertyName="GroupName" />
                    </CollectionViewSource.GroupDescriptions>
                </CollectionViewSource>
            </Border.Resources>

            <ComboBox Height="Auto"
                      Margin="0,0,0,1"
                      Padding="5,0"
                      Cattach.ItemHeight="Auto"
                      Cattach.UseGuide="False"
                      DisplayMemberPath="{Binding DisplayMemberPath}"
                      ItemsSource="{Binding Source={StaticResource GroupedNodeDatas}}"
                      SelectedItem="{Binding Value}"
                      SelectedValuePath="{Binding SelectedValuePath}">
                <ItemsControl.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.Panel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel />
                            </ItemsPanelTemplate>
                        </GroupStyle.Panel>
                        <GroupStyle.ContainerStyle>
                            <Style TargetType="{x:Type GroupItem}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GroupItem}">
                                            <Expander BorderThickness="0"
                                                      Cattach.CaptionBackground="{x:Null}"
                                                      Header="{Binding Name}">
                                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                                    <ItemsPresenter Margin="12,0,0,0" />
                                                </ScrollViewer>
                                            </Expander>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </GroupStyle.ContainerStyle>
                    </GroupStyle>
                </ItemsControl.GroupStyle>
            </ComboBox>
        </Border>
    </DataTemplate>
</ResourceDictionary>