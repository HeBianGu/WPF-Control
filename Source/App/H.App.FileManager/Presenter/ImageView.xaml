<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
                    xmlns:h="https://github.com/HeBianGu"
                    xmlns:local="clr-namespace:H.App.FileManager">
    <DataTemplate DataType="{x:Type local:fm_dd_image}">
        <Grid>
            <DockPanel>
                <Border BorderBrush="{DynamicResource {x:Static h:BrushKeys.BorderBrush}}"
                        BorderThickness="1">
                    <Grid Margin="5">
                        <Image Width="100"
                               Source="{Binding Url, Converter={x:Static h:ConverterEx.GetFileImageSourceInMemory}, ConverterParameter=100, IsAsync=True}" />
                        <Image Width="30"
                               Height="30"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Bottom"
                               Source="{Binding Url, Converter={h:GetFilePathToSystemInfoIconConverter}, IsAsync=True, ConverterParameter=100}" />
                    </Grid>
                </Border>
                <ItemsControl MinWidth="50"
                              Margin="5"
                              ToolTip="{Binding Url}">
                    <TextBlock MaxHeight="50"
                               FontWeight="Bold"
                               Text="{Binding Name}"
                               TextTrimming="CharacterEllipsis"
                               TextWrapping="Wrap"
                               ToolTip="{Binding Name}" />
                    <TextBlock Foreground="{DynamicResource {x:Static h:BrushKeys.Orange}}"
                               Text="{Binding FavoritePath}"
                               ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />
                    <TextBlock Foreground="{DynamicResource {x:Static h:BrushKeys.Green}}"
                               Text="{Binding Object}"
                               ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />
                    <TextBlock Foreground="{DynamicResource {x:Static h:BrushKeys.Orange}}"
                               Text="{Binding Tags}"
                               ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />
                    <TextBlock Foreground="{DynamicResource {x:Static h:BrushKeys.Pink}}"
                               Text="{Binding Area}"
                               ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />
                    <TextBlock Foreground="{DynamicResource {x:Static h:BrushKeys.LightBlue}}"
                               Text="{Binding Articulation}"
                               ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />
                </ItemsControl>
            </DockPanel>
            <Border HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Background="{DynamicResource {x:Static h:BrushKeys.Red}}"
                    CornerRadius="{DynamicResource {x:Static LayoutKeys.CornerRadius}}"
                    Visibility="{Binding Watched, Converter={x:Static h:Converter.GetTrueToCollapsed}}">
                <TextBlock Margin="5,3"
                           Foreground="White"
                           Text="New" />
            </Border>

            <TextBlock HorizontalAlignment="Left"
                       VerticalAlignment="Bottom"
                       FontWeight="Bold"
                       Foreground="{DynamicResource {x:Static h:BrushKeys.Orange}}">
                <Run Text="{Binding Score}" /><Run Text="分" />
            </TextBlock>

            <FontIconToggleButton Width="20"
                                  Height="20"
                                  Padding="2"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Bottom"
                                  Background="Transparent"
                                  BorderThickness="0"
                                  CheckedGlyph="{x:Static FontIcons.HeartFill}"
                                  IsChecked="{Binding Favorite, Mode=TwoWay}"
                                  UncheckedGlyph="{x:Static FontIcons.Heart}">
                <FontIconToggleButton.Style>
                    <Style BasedOn="{StaticResource {x:Static FontIconToggleButtonKeys.Default}}"
                           TargetType="FontIconToggleButton">
                        <Style.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static h:BrushKeys.Red}}" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </FontIconToggleButton.Style>
            </FontIconToggleButton>
        </Grid>
    </DataTemplate>


    <DataTemplate DataType="{x:Type local:ImageView}">
        <Grid>
            <h:Zoombox x:Name="zoomview"
                       Background="Transparent"
                       DragModifiers=""
                       Focusable="True"
                       IsTabStop="True"
                       NavigateOnPreview="False"
                       RelativeZoomModifiers=""
                       ViewStackIndex="0"
                       ZoomOn="Content">
                <h:Zoombox.ViewStack>
                    <!--<h:ZoomboxView>Empty</h:ZoomboxView>-->
                    <h:ZoomboxView>Fit</h:ZoomboxView>
                    <!--<h:ZoomboxView>Fill</h:ZoomboxView>
                    <h:ZoomboxView>Center</h:ZoomboxView>
                    <h:ZoomboxView>10 10 100 100</h:ZoomboxView>
                    <h:ZoomboxView>2.0</h:ZoomboxView>-->
                </h:Zoombox.ViewStack>
                <b:Interaction.Triggers>
                    <h:MouseTrigger ClickCount="2"
                                    Mode="Right"
                                    MouseButton="Left"
                                    UseHandle="False">
                        <!--<b:InvokeCommandAction Command="{Binding Source={x:Static h:IocProject.Instance}, Path=Current.File.NextCommand}" />-->
                        <h:CallMethodActionEx MethodName="FitToBounds"
                                              TargetObject="{Binding ElementName=zoomview}" />
                    </h:MouseTrigger>
                    <h:MouseTrigger ClickCount="2"
                                    Mode="Left"
                                    MouseButton="Left"
                                    UseHandle="False">
                        <!--<b:InvokeCommandAction Command="{Binding Source={x:Static h:IocProject.Instance}, Path=Current.File.PreviousCommand}" />-->
                        <h:CallMethodActionEx MethodName="FitToBounds"
                                              TargetObject="{Binding ElementName=zoomview}" />
                    </h:MouseTrigger>
                </b:Interaction.Triggers>
                <Image Source="{Binding Model.Url, NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="SourceUpdated">
                            <h:CallMethodActionEx MethodName="FitToBounds"
                                                  TargetObject="{Binding ElementName=zoomview}" />
                        </b:EventTrigger>
                        <b:EventTrigger EventName="TargetUpdated">
                            <h:CallMethodActionEx MethodName="FitToBounds"
                                                  TargetObject="{Binding ElementName=zoomview}" />
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </Image>
            </h:Zoombox>
            <DockPanel HorizontalAlignment="Right"
                       VerticalAlignment="Top"
                       DockPanel.Dock="Top"
                       LastChildFill="False">
                <FontIconButton Command="{x:Static h:Zoombox.Fit}"
                                CommandTarget="{Binding ElementName=zoomview}"
                                Content="{x:Static FontIcons.FitPage}"
                                DockPanel.Dock="Right"
                                ToolTip="适配" />

                <FontIconButton Command="{x:Static h:Zoombox.Fill}"
                                CommandTarget="{Binding ElementName=zoomview}"
                                Content="{x:Static FontIcons.FullScreen}"
                                DockPanel.Dock="Right"
                                ToolTip="填充" />

                <FontIconButton Command="{Binding Source={x:Static h:IocProject.Instance}, Path=Current.File.NextCommand}"
                                Content="{x:Static FontIcons.Next}"
                                DockPanel.Dock="Right"
                                ToolTip="下一个" />
                <FontIconButton Command="{Binding Source={x:Static h:IocProject.Instance}, Path=Current.File.PreviousCommand}"
                                Content="{x:Static FontIcons.Previous}"
                                DockPanel.Dock="Right"
                                ToolTip="上一个" />

            </DockPanel>
        </Grid>
    </DataTemplate>
</ResourceDictionary>